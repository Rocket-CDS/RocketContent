@inherits RocketContent.Components.RocketContentTokens<Simplisity.SimplisityRazor>
@using DNNrocketAPI.Components;
@using RocketContent.Components;
@using Simplisity;
@using RazorEngine.Text;
@using Rocket.AppThemes.Components;

@AddProcessData("resourcepath", "/DesktopModules/DNNrocket/api/App_LocalResources/")
@AddProcessData("resourcepath", "/DesktopModules/DNNrocketModules/RocketContent/App_LocalResources/")

@{
    var appThemeList = (AppThemeDataList)Model.List.First();
    var remoteModule = (RemoteModule)Model.GetDataObject("remotemodule");
    var info  = new SimplisityInfo(remoteModule.Record);
}

<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>


<div id="a-selectapptheme" class="w3-container w3-margin w3-padding">

    <div class="w3-row">
        <div class="w3-half w3-padding">
            <div class="w3-large">@ResourceKey("RC.name")</div>
            @TextBox(info, "genxml/remote/name", " class='w3-input w3-border ' ", remoteModule.ModuleRef)
        </div>
        <div class="w3-half w3-padding">
            <div class="w3-large">ModuleRef</div>
            <div class="w3-input w3-border w3-light-grey">@remoteModule.ModuleRef</div>
        </div>
    </div>
    <div class="w3-row">
        <div class="w3-half w3-padding">
            <div class="w3-large">@ResourceKey("RC.apptheme")</div>
            <select id="apptheme" s-xpath="genxml/remote/apptheme" s-update="save" class="w3-input" style="width:100%">
                <option value="" versionfolder=""></option>
                @foreach (var appTheme in appThemeList.List)
                {
                    var selectedvalue = "";
                    if (remoteModule.Record.GetXmlProperty("genxml/remote/apptheme") == appTheme.AppThemeFolder)
                    {
                        selectedvalue = "selected";
                    }
                    <option value="@appTheme.AppThemeFolder" @selectedvalue versionfolder="@appTheme.AppVersionFolder">@appTheme.Name</option>
                }
            </select>
        </div>
        <div class="w3-half w3-padding">
            &nbsp;
        </div>
    </div>

    <div class="w3-row">
        <div class="w3-half w3-padding">
            <div class="w3-button" onclick="$('#advancedsettings').toggle();">Advanced</div>
        </div>
        <div class="w3-half w3-padding">
            &nbsp;
        </div>

    </div>

    <div id="advancedsettings" class="w3-row" style="display:none;">
        <div class="w3-row">
            <div class="w3-half w3-padding">
                <div class="w3-large">@ResourceKey("RC.datasourceref")</div>
                @TextBox(info, "genxml/remote/datasourceref", " class='w3-input w3-border ' placeholder='" + remoteModule.ModuleRef + "' ", "")
            </div>
            <div class="w3-half w3-padding">
            </div>
        </div>
        <div class="w3-row">
            <div class="w3-half w3-padding">
                <div class="w3-large">@ResourceKey("RC.viewapptheme")</div>
                <select id="appthemeview" s-xpath="genxml/remote/appthemeview" s-update="save" class="w3-input " style="width:100%">
                    <option value="" versionfolder=""></option>
                    @foreach (var appTheme in appThemeList.List)
                    {
                        var selectedvalue2 = "";
                        if (remoteModule.Record.GetXmlProperty("genxml/select/appthemeview") == appTheme.AppThemeFolder)
                        {
                            selectedvalue2 = "selected";
                        }
                        <option value="@appTheme.AppThemeFolder" @selectedvalue2 versionfolder="@appTheme.AppVersionFolder">@appTheme.Name</option>
                    }
                </select>
            </div>
            <div class="w3-half w3-padding">
            </div>
        </div>
    </div>


</div>

<div class="w3-row w3-padding w3-center">
    <div class="w3-button w3-green simplisity_click" s-cmd="remote_settingssave" s-post="#a-selectapptheme" s-fields='{"moduleref":"@Model.ModuleRef"}'>@ButtonText(ButtonTypes.save)</div>
</div>


<script>

    $(document).ready(function () {
        $('#apptheme').select2();
        $('#appthemeview').select2();
    });
</script>


